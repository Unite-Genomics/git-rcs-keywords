
This module provides a means to add keyword expansion of the following 
standard source tags to your terraform projects:

  tags = {
    TF_Portal         = var.portal_name
    TF_Workspace      = terraform.workspace
    TF_User           = "@@User@@"
    TF_DriverRepo     = "@@Driver@@"
    TF_Version        = "@@Version@@"
    TF_RunDate        = "@@Date@@"
    TF_ModuleRepo     = "@@Module@@"
    TF_SourceRevision = "@@Revision@@"
    TF_SourceFile     = "@@Source@@"
    TF_SourceLine     = "@@Line@@"
  }

The mechanism used is a combination of source parsing of *.tf to apply the tags (see tfapply in the portal-deployments repo) and the clean filter.   The clean filter is run when source is staged, to remove any keyword expansion date.  Thus the tags are only expanded on the local disk, not in the repository itself.

To start, you need to add the following to ~/.gitconfig:

[filter "rcs-keywords"]
    clean  = ~/git/git-rcs-keywords/.git_filters/rcs-keywords.clean

Then, to add keyword expansion, simply add these files to your project:
    <project>/.gitattributes                    - *.tf filter=rcs-keywords

